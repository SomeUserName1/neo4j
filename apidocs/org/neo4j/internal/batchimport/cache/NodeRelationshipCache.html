<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (11.0.8) on Wed Dec 02 12:58:02 CET 2020 -->
<title>NodeRelationshipCache (Neo4j 4.2.2-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2020-12-02">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="NodeRelationshipCache (Neo4j 4.2.2-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":9,"i2":9,"i3":9,"i4":10,"i5":9,"i6":10,"i7":9,"i8":9,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":9,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":9,"i21":10,"i22":10,"i23":9,"i24":10,"i25":10,"i26":10,"i27":10,"i28":10,"i29":9,"i30":10,"i31":9,"i32":10,"i33":10,"i34":10,"i35":10,"i36":9,"i37":10,"i38":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/NodeRelationshipCache.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.neo4j.internal.batchimport.cache</a></div>
<h2 title="Class NodeRelationshipCache" class="title">Class NodeRelationshipCache</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.neo4j.internal.batchimport.cache.NodeRelationshipCache</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang" class="externalLink">AutoCloseable</a></code>, <code><a href="MemoryStatsVisitor.Visitable.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor.Visitable</a></code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">NodeRelationshipCache</span>
extends <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>
implements <a href="MemoryStatsVisitor.Visitable.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor.Visitable</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang" class="externalLink">AutoCloseable</a></pre>
<div class="block">Caches of parts of node store and relationship group store. A crucial part of batch import where
 any random access must be covered by this cache. All I/O, both read and write must be sequential.

 <pre>
 Main array (index into array is nodeId):
 [ID,DEGREE]

 ID means:
 - DEGREE >= THRESHOLD: pointer into RelationshipGroupCache array
   RelationshipGroupCache array:
   [NEXT,OUT_ID,OUT_DEGREE,IN_ID,IN_DEGREE,LOOP_ID,LOOP_DEGREE]
 - DEGREE < THRESHOLD: last seen relationship id for this node
 </pre>

 This class is designed to be thread safe if callers are coordinated such that different threads owns different
 parts of the main cache array, with the constraint that a thread which accesses item N must continue doing
 so in order to make further changes to N, if another thread accesses N the semantics will no longer hold.

 Since multiple threads are making changes external memory synchronization is also required in between
 a phase of making changes using <a href="#getAndPutRelationship(long,int,org.neo4j.graphdb.Direction,long,boolean)"><code>getAndPutRelationship(long, int, Direction, long, boolean)</code></a> and e.g
 <a href="#visitChangedNodes(org.neo4j.internal.batchimport.cache.NodeRelationshipCache.NodeChangeVisitor,int)"><code>visitChangedNodes(NodeChangeVisitor, int)</code></a>.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="NodeRelationshipCache.GroupVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.GroupVisitor</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="NodeRelationshipCache.NodeChangeVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.NodeChangeVisitor</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="NodeRelationshipCache.RelGroupCache.html" title="class in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.RelGroupCache</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#array">array</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="NumberArrayFactory.html" title="interface in org.neo4j.internal.batchimport.cache">NumberArrayFactory</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#arrayFactory">arrayFactory</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#BIG_COUNT_MASK">BIG_COUNT_MASK</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="LongArray.html" title="interface in org.neo4j.internal.batchimport.cache">LongArray</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#bigCounts">bigCounts</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/atomic/AtomicInteger.html?is-external=true" title="class or interface in java.util.concurrent.atomic" class="externalLink">AtomicInteger</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#bigCountsCursor">bigCountsCursor</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#CHUNK_SIZE">CHUNK_SIZE</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#chunkChangedArray">chunkChangedArray</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#chunkSize">chunkSize</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#COUNT_FLAGS_MASKS">COUNT_FLAGS_MASKS</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#COUNT_MASK">COUNT_MASK</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#COUNT_SIZE">COUNT_SIZE</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DENSE_NODE_CHANGED_MASK">DENSE_NODE_CHANGED_MASK</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#denseNodeThreshold">denseNodeThreshold</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#EMPTY">EMPTY</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#forward">forward</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#GROUP_ENTRY_SIZE">GROUP_ENTRY_SIZE</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#highNodeId">highNodeId</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#ID_AND_COUNT_SIZE">ID_AND_COUNT_SIZE</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#ID_SIZE">ID_SIZE</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#MAX_COUNT">MAX_COUNT</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#MAX_RELATIONSHIP_ID">MAX_RELATIONSHIP_ID</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#MAX_SMALL_COUNT">MAX_SMALL_COUNT</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../memory/MemoryTracker.html" title="interface in org.neo4j.memory">MemoryTracker</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#memoryTracker">memoryTracker</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="NodeRelationshipCache.GroupVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.GroupVisitor</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#NO_GROUP_VISITOR">NO_GROUP_VISITOR</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#numberOfDenseNodes">numberOfDenseNodes</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="NodeRelationshipCache.RelGroupCache.html" title="class in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.RelGroupCache</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#relGroupCache">relGroupCache</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#SPARSE_COUNT_OFFSET">SPARSE_COUNT_OFFSET</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#SPARSE_ID_OFFSET">SPARSE_ID_OFFSET</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#SPARSE_NODE_CHANGED_MASK">SPARSE_NODE_CHANGED_MASK</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#TYPE_SIZE">TYPE_SIZE</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.neo4j.internal.batchimport.cache.NumberArrayFactory,int,int,long,org.neo4j.memory.MemoryTracker)">NodeRelationshipCache</a></span>&#8203;(<a href="NumberArrayFactory.html" title="interface in org.neo4j.internal.batchimport.cache">NumberArrayFactory</a>&nbsp;arrayFactory,
                     int&nbsp;denseNodeThreshold,
                     int&nbsp;chunkSize,
                     long&nbsp;base,
                     <a href="../../../memory/MemoryTracker.html" title="interface in org.neo4j.memory">MemoryTracker</a>&nbsp;memoryTracker)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.neo4j.internal.batchimport.cache.NumberArrayFactory,int,org.neo4j.memory.MemoryTracker)">NodeRelationshipCache</a></span>&#8203;(<a href="NumberArrayFactory.html" title="interface in org.neo4j.internal.batchimport.cache">NumberArrayFactory</a>&nbsp;arrayFactory,
                     int&nbsp;denseNodeThreshold,
                     <a href="../../../memory/MemoryTracker.html" title="interface in org.neo4j.memory">MemoryTracker</a>&nbsp;memoryTracker)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acceptMemoryStatsVisitor(org.neo4j.internal.batchimport.cache.MemoryStatsVisitor)">acceptMemoryStatsVisitor</a></span>&#8203;(<a href="MemoryStatsVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor</a>&nbsp;visitor)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#all48Bits(long)">all48Bits</a></span>&#8203;(long&nbsp;raw)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#all48Bits(org.neo4j.internal.batchimport.cache.ByteArray,long,int)">all48Bits</a></span>&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
         long&nbsp;index,
         int&nbsp;offset)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>private static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#assertValidCount(long,long)">assertValidCount</a></span>&#8203;(long&nbsp;nodeId,
                long&nbsp;count)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#calculateMaxMemoryUsage(long)">calculateMaxMemoryUsage</a></span>&#8203;(long&nbsp;numberOfRelationships)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#calculateMaxMemoryUsage(long,long)">calculateMaxMemoryUsage</a></span>&#8203;(long&nbsp;numberOfDenseNodes,
                       long&nbsp;numberOfRelationships)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>(package private) long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#calculateNumberOfDenseNodes()">calculateNumberOfDenseNodes</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#changeMask(boolean)">changeMask</a></span>&#8203;(boolean&nbsp;dense)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#chunkChangeMask(boolean)">chunkChangeMask</a></span>&#8203;(boolean&nbsp;dense)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#chunkHasChange(long,byte)">chunkHasChange</a></span>&#8203;(long&nbsp;nodeId,
              byte&nbsp;chunkMask)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>private int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#chunkOf(long)">chunkOf</a></span>&#8203;(long&nbsp;nodeId)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#clearChangedChunks(boolean)">clearChangedChunks</a></span>&#8203;(boolean&nbsp;denseNodes)</code></th>
<td class="colLast">
<div class="block">Clears the high-level change marks.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#close()">close</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#countingCompleted()">countingCompleted</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>private static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#countValue(int)">countValue</a></span>&#8203;(int&nbsp;rawCount)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getAndPutRelationship(long,int,org.neo4j.graphdb.Direction,long,boolean)">getAndPutRelationship</a></span>&#8203;(long&nbsp;nodeId,
                     int&nbsp;typeId,
                     <a href="../../../graphdb/Direction.html" title="enum in org.neo4j.graphdb">Direction</a>&nbsp;direction,
                     long&nbsp;firstRelId,
                     boolean&nbsp;incrementCount)</code></th>
<td class="colLast">
<div class="block">Puts a relationship id to be the head of a relationship chain.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCount(long,int,org.neo4j.graphdb.Direction)">getCount</a></span>&#8203;(long&nbsp;nodeId,
        int&nbsp;typeId,
        <a href="../../../graphdb/Direction.html" title="enum in org.neo4j.graphdb">Direction</a>&nbsp;direction)</code></th>
<td class="colLast">
<div class="block">Returns the count (degree) of the requested relationship chain.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>private long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCount(org.neo4j.internal.batchimport.cache.ByteArray,long,int)">getCount</a></span>&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
        long&nbsp;index,
        int&nbsp;offset)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getFirstRel(long,org.neo4j.internal.batchimport.cache.NodeRelationshipCache.GroupVisitor)">getFirstRel</a></span>&#8203;(long&nbsp;nodeId,
           <a href="NodeRelationshipCache.GroupVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.GroupVisitor</a>&nbsp;visitor)</code></th>
<td class="colLast">
<div class="block">Used when setting node nextRel fields.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getNumberOfDenseNodes()">getNumberOfDenseNodes</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>private static long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getRelationshipId(org.neo4j.internal.batchimport.cache.ByteArray,long)">getRelationshipId</a></span>&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                 long&nbsp;nodeId)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#incrementCount(long)">incrementCount</a></span>&#8203;(long&nbsp;nodeId)</code></th>
<td class="colLast">
<div class="block">Increment relationship count for <code>nodeId</code>.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>private long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#incrementCount(org.neo4j.internal.batchimport.cache.ByteArray,long,int)">incrementCount</a></span>&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
              long&nbsp;index,
              int&nbsp;offset)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code>private static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isBigCount(int)">isBigCount</a></span>&#8203;(int&nbsp;storedCount)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isDense(long)">isDense</a></span>&#8203;(long&nbsp;nodeId)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isDense(org.neo4j.internal.batchimport.cache.ByteArray,long)">isDense</a></span>&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
       long&nbsp;nodeId)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#markAsChanged(org.neo4j.internal.batchimport.cache.ByteArray,long,int)">markAsChanged</a></span>&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
             long&nbsp;nodeId,
             int&nbsp;mask)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i27" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#markChunkAsChanged(long,boolean)">markChunkAsChanged</a></span>&#8203;(long&nbsp;nodeId,
                  boolean&nbsp;dense)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i28" class="altColor">
<td class="colFirst"><code><a href="MemoryStatsVisitor.Visitable.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor.Visitable</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#memoryEstimation(long)">memoryEstimation</a></span>&#8203;(long&nbsp;numberOfNodes)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i29" class="rowColor">
<td class="colFirst"><code>private static byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#minusOneBytes(int)">minusOneBytes</a></span>&#8203;(int&nbsp;length)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i30" class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#nodeIsChanged(org.neo4j.internal.batchimport.cache.ByteArray,long,long)">nodeIsChanged</a></span>&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
             long&nbsp;nodeId,
             long&nbsp;mask)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i31" class="rowColor">
<td class="colFirst"><code>(package private) static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#nullSafeMemoryStatsVisitor(org.neo4j.internal.batchimport.cache.MemoryStatsVisitor.Visitable,org.neo4j.internal.batchimport.cache.MemoryStatsVisitor)">nullSafeMemoryStatsVisitor</a></span>&#8203;(<a href="MemoryStatsVisitor.Visitable.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor.Visitable</a>&nbsp;visitable,
                          <a href="MemoryStatsVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor</a>&nbsp;visitor)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i32" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setCount(long,long,int,org.neo4j.graphdb.Direction)">setCount</a></span>&#8203;(long&nbsp;nodeId,
        long&nbsp;count,
        int&nbsp;typeId,
        <a href="../../../graphdb/Direction.html" title="enum in org.neo4j.graphdb">Direction</a>&nbsp;direction)</code></th>
<td class="colLast">
<div class="block">Should only be used by tests</div>
</td>
</tr>
<tr id="i33" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setCount(org.neo4j.internal.batchimport.cache.ByteArray,long,int,long)">setCount</a></span>&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
        long&nbsp;index,
        int&nbsp;offset,
        long&nbsp;count)</code></th>
<td class="colLast">
<div class="block">This method sets count (node degree, really).</div>
</td>
</tr>
<tr id="i34" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setForwardScan(boolean,boolean)">setForwardScan</a></span>&#8203;(boolean&nbsp;forward,
              boolean&nbsp;denseNodes)</code></th>
<td class="colLast">
<div class="block">First a note about tracking which nodes have been updated with new relationships by calls to
 <a href="#getAndPutRelationship(long,int,org.neo4j.graphdb.Direction,long,boolean)"><code>getAndPutRelationship(long, int, Direction, long, boolean)</code></a>:

 We use two high bits of the count field in the "main" array to mark whether or not a change
 have been made to a node.</div>
</td>
</tr>
<tr id="i35" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setNodeCount(long)">setNodeCount</a></span>&#8203;(long&nbsp;nodeCount)</code></th>
<td class="colLast">
<div class="block">Called by the one calling <a href="#incrementCount(long)"><code>incrementCount(long)</code></a> after all nodes have been added.</div>
</td>
</tr>
<tr id="i36" class="altColor">
<td class="colFirst"><code>private static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setRelationshipId(org.neo4j.internal.batchimport.cache.ByteArray,long,long)">setRelationshipId</a></span>&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                 long&nbsp;nodeId,
                 long&nbsp;firstRelId)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i37" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toString()">toString</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i38" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#visitChangedNodes(org.neo4j.internal.batchimport.cache.NodeRelationshipCache.NodeChangeVisitor,int)">visitChangedNodes</a></span>&#8203;(<a href="NodeRelationshipCache.NodeChangeVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.NodeChangeVisitor</a>&nbsp;visitor,
                 int&nbsp;nodeTypes)</code></th>
<td class="colLast">
<div class="block">Efficiently visits changed nodes, e.g. nodes that have had any relationship chain updated by
 <a href="#getAndPutRelationship(long,int,org.neo4j.graphdb.Direction,long,boolean)"><code>getAndPutRelationship(long, int, Direction, long, boolean)</code></a>.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="CHUNK_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CHUNK_SIZE</h4>
<pre>private static final&nbsp;int CHUNK_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.CHUNK_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="EMPTY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>EMPTY</h4>
<pre>private static final&nbsp;long EMPTY</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.EMPTY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="MAX_RELATIONSHIP_ID">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MAX_RELATIONSHIP_ID</h4>
<pre>private static final&nbsp;long MAX_RELATIONSHIP_ID</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.MAX_RELATIONSHIP_ID">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="MAX_SMALL_COUNT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MAX_SMALL_COUNT</h4>
<pre>static final&nbsp;int MAX_SMALL_COUNT</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.MAX_SMALL_COUNT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="MAX_COUNT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MAX_COUNT</h4>
<pre>static final&nbsp;long MAX_COUNT</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.MAX_COUNT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="ID_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ID_SIZE</h4>
<pre>private static final&nbsp;int ID_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.ID_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="COUNT_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>COUNT_SIZE</h4>
<pre>private static final&nbsp;int COUNT_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.COUNT_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="ID_AND_COUNT_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ID_AND_COUNT_SIZE</h4>
<pre>private static final&nbsp;int ID_AND_COUNT_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.ID_AND_COUNT_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="SPARSE_ID_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SPARSE_ID_OFFSET</h4>
<pre>private static final&nbsp;int SPARSE_ID_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.SPARSE_ID_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="SPARSE_COUNT_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SPARSE_COUNT_OFFSET</h4>
<pre>private static final&nbsp;int SPARSE_COUNT_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.SPARSE_COUNT_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="DENSE_NODE_CHANGED_MASK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DENSE_NODE_CHANGED_MASK</h4>
<pre>private static final&nbsp;int DENSE_NODE_CHANGED_MASK</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.DENSE_NODE_CHANGED_MASK">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="SPARSE_NODE_CHANGED_MASK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SPARSE_NODE_CHANGED_MASK</h4>
<pre>private static final&nbsp;int SPARSE_NODE_CHANGED_MASK</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.SPARSE_NODE_CHANGED_MASK">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="BIG_COUNT_MASK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BIG_COUNT_MASK</h4>
<pre>private static final&nbsp;int BIG_COUNT_MASK</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.BIG_COUNT_MASK">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="COUNT_FLAGS_MASKS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>COUNT_FLAGS_MASKS</h4>
<pre>private static final&nbsp;int COUNT_FLAGS_MASKS</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.COUNT_FLAGS_MASKS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="COUNT_MASK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>COUNT_MASK</h4>
<pre>private static final&nbsp;int COUNT_MASK</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.COUNT_MASK">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="TYPE_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_SIZE</h4>
<pre>private static final&nbsp;int TYPE_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.neo4j.internal.batchimport.cache.NodeRelationshipCache.TYPE_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="GROUP_ENTRY_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>GROUP_ENTRY_SIZE</h4>
<pre>public static final&nbsp;int GROUP_ENTRY_SIZE</pre>
</li>
</ul>
<a id="array">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>array</h4>
<pre>private&nbsp;<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a> array</pre>
</li>
</ul>
<a id="chunkChangedArray">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chunkChangedArray</h4>
<pre>private&nbsp;byte[] chunkChangedArray</pre>
</li>
</ul>
<a id="denseNodeThreshold">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>denseNodeThreshold</h4>
<pre>private final&nbsp;int denseNodeThreshold</pre>
</li>
</ul>
<a id="memoryTracker">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>memoryTracker</h4>
<pre>private final&nbsp;<a href="../../../memory/MemoryTracker.html" title="interface in org.neo4j.memory">MemoryTracker</a> memoryTracker</pre>
</li>
</ul>
<a id="relGroupCache">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>relGroupCache</h4>
<pre>private final&nbsp;<a href="NodeRelationshipCache.RelGroupCache.html" title="class in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.RelGroupCache</a> relGroupCache</pre>
</li>
</ul>
<a id="highNodeId">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>highNodeId</h4>
<pre>private&nbsp;long highNodeId</pre>
</li>
</ul>
<a id="forward">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>forward</h4>
<pre>private volatile&nbsp;boolean forward</pre>
</li>
</ul>
<a id="chunkSize">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chunkSize</h4>
<pre>private final&nbsp;int chunkSize</pre>
</li>
</ul>
<a id="arrayFactory">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>arrayFactory</h4>
<pre>private final&nbsp;<a href="NumberArrayFactory.html" title="interface in org.neo4j.internal.batchimport.cache">NumberArrayFactory</a> arrayFactory</pre>
</li>
</ul>
<a id="bigCounts">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bigCounts</h4>
<pre>private final&nbsp;<a href="LongArray.html" title="interface in org.neo4j.internal.batchimport.cache">LongArray</a> bigCounts</pre>
</li>
</ul>
<a id="bigCountsCursor">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bigCountsCursor</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/atomic/AtomicInteger.html?is-external=true" title="class or interface in java.util.concurrent.atomic" class="externalLink">AtomicInteger</a> bigCountsCursor</pre>
</li>
</ul>
<a id="numberOfDenseNodes">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>numberOfDenseNodes</h4>
<pre>private&nbsp;long numberOfDenseNodes</pre>
</li>
</ul>
<a id="NO_GROUP_VISITOR">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>NO_GROUP_VISITOR</h4>
<pre>public static final&nbsp;<a href="NodeRelationshipCache.GroupVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.GroupVisitor</a> NO_GROUP_VISITOR</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(org.neo4j.internal.batchimport.cache.NumberArrayFactory,int,org.neo4j.memory.MemoryTracker)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NodeRelationshipCache</h4>
<pre>public&nbsp;NodeRelationshipCache&#8203;(<a href="NumberArrayFactory.html" title="interface in org.neo4j.internal.batchimport.cache">NumberArrayFactory</a>&nbsp;arrayFactory,
                             int&nbsp;denseNodeThreshold,
                             <a href="../../../memory/MemoryTracker.html" title="interface in org.neo4j.memory">MemoryTracker</a>&nbsp;memoryTracker)</pre>
</li>
</ul>
<a id="&lt;init&gt;(org.neo4j.internal.batchimport.cache.NumberArrayFactory,int,int,long,org.neo4j.memory.MemoryTracker)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>NodeRelationshipCache</h4>
<pre>NodeRelationshipCache&#8203;(<a href="NumberArrayFactory.html" title="interface in org.neo4j.internal.batchimport.cache">NumberArrayFactory</a>&nbsp;arrayFactory,
                      int&nbsp;denseNodeThreshold,
                      int&nbsp;chunkSize,
                      long&nbsp;base,
                      <a href="../../../memory/MemoryTracker.html" title="interface in org.neo4j.memory">MemoryTracker</a>&nbsp;memoryTracker)</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="minusOneBytes(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>minusOneBytes</h4>
<pre class="methodSignature">private static&nbsp;byte[]&nbsp;minusOneBytes&#8203;(int&nbsp;length)</pre>
</li>
</ul>
<a id="incrementCount(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>incrementCount</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;incrementCount&#8203;(long&nbsp;nodeId)</pre>
<div class="block">Increment relationship count for <code>nodeId</code>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>nodeId</code> - node to increment relationship count for.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>count after the increment.</dd>
</dl>
</li>
</ul>
<a id="setCount(long,long,int,org.neo4j.graphdb.Direction)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setCount</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setCount&#8203;(long&nbsp;nodeId,
                     long&nbsp;count,
                     int&nbsp;typeId,
                     <a href="../../../graphdb/Direction.html" title="enum in org.neo4j.graphdb">Direction</a>&nbsp;direction)</pre>
<div class="block">Should only be used by tests</div>
</li>
</ul>
<a id="setCount(org.neo4j.internal.batchimport.cache.ByteArray,long,int,long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setCount</h4>
<pre class="methodSignature">private&nbsp;void&nbsp;setCount&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                      long&nbsp;index,
                      int&nbsp;offset,
                      long&nbsp;count)</pre>
<div class="block">This method sets count (node degree, really). It's somewhat generic in that it accepts
 array and offset to set the count into. This is due to there being multiple places where
 we store counts. Simplest one is for sparse nodes, which live in the main
 NodeRelationshipCache.array at the dedicated offset. Other counts live in RelGroupCache.array
 which contain three counts, one for each direction. That's covered by array and offset,
 the count field works the same in all those scenarios. It's an integer which happens to have
 some other flags at msb, so it's the 29 lsb bits which represents the count. 2^29 is merely
 1/2bn and so the count field has its 30th bit marking whether or not it's a "big count",
 if it is then the 29 count bits instead point to an array index/slot into bigCounts array
 which has much bigger space per count. This is of course quite rare, but nice to support.

 <pre>
 "small" count, i.e. < 2^29
 [  0c,cccc][cccc,cccc][cccc,cccc][cccc,cccc]
    
           bits containing actual count
  0 marking that this is a small count

 "big" count, i.e. >= 2^29
 [  1i,iiii][iiii,iiii][iiii,iiii][iiii,iiii]
    
        bits containing array index into bigCounts array which contains the actual count
  1 marking that this is a big count
 </pre>

 so the bigCounts array is shared between all different types of counts, because big counts are so rare</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>array</code> - <a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache"><code>ByteArray</code></a> to set count in</dd>
<dd><code>index</code> - node id, i.e. array index</dd>
<dd><code>offset</code> - offset on that array index (a ByteArray feature)</dd>
<dd><code>count</code> - count to set at this position</dd>
</dl>
</li>
</ul>
<a id="assertValidCount(long,long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assertValidCount</h4>
<pre class="methodSignature">private static&nbsp;void&nbsp;assertValidCount&#8203;(long&nbsp;nodeId,
                                     long&nbsp;count)</pre>
</li>
</ul>
<a id="isBigCount(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isBigCount</h4>
<pre class="methodSignature">private static&nbsp;boolean&nbsp;isBigCount&#8203;(int&nbsp;storedCount)</pre>
</li>
</ul>
<a id="setNodeCount(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setNodeCount</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setNodeCount&#8203;(long&nbsp;nodeCount)</pre>
<div class="block">Called by the one calling <a href="#incrementCount(long)"><code>incrementCount(long)</code></a> after all nodes have been added.
 Done like this since currently it's just overhead trying to maintain a high id in the face
 of current updates, whereas it's much simpler to do this from the code incrementing the counts.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>nodeCount</code> - high node id in the store, e.g. the highest node id + 1</dd>
</dl>
</li>
</ul>
<a id="getCount(org.neo4j.internal.batchimport.cache.ByteArray,long,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCount</h4>
<pre class="methodSignature">private&nbsp;long&nbsp;getCount&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                      long&nbsp;index,
                      int&nbsp;offset)</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#setCount(org.neo4j.internal.batchimport.cache.ByteArray,long,int,long)"><code>setCount for description on how bigCounts work</code></a></dd>
</dl>
</li>
</ul>
<a id="countValue(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>countValue</h4>
<pre class="methodSignature">private static&nbsp;int&nbsp;countValue&#8203;(int&nbsp;rawCount)</pre>
</li>
</ul>
<a id="incrementCount(org.neo4j.internal.batchimport.cache.ByteArray,long,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>incrementCount</h4>
<pre class="methodSignature">private&nbsp;long&nbsp;incrementCount&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                            long&nbsp;index,
                            int&nbsp;offset)</pre>
</li>
</ul>
<a id="isDense(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isDense</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;isDense&#8203;(long&nbsp;nodeId)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>nodeId</code> - node to check whether dense or not.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>whether or not the given <code>nodeId</code> is dense. A node is sparse if it has less relationships,
 e.g. has had less calls to <a href="#incrementCount(long)"><code>incrementCount(long)</code></a>, then the given dense node threshold.</dd>
</dl>
</li>
</ul>
<a id="isDense(org.neo4j.internal.batchimport.cache.ByteArray,long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isDense</h4>
<pre class="methodSignature">private&nbsp;boolean&nbsp;isDense&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                        long&nbsp;nodeId)</pre>
</li>
</ul>
<a id="getAndPutRelationship(long,int,org.neo4j.graphdb.Direction,long,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAndPutRelationship</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getAndPutRelationship&#8203;(long&nbsp;nodeId,
                                  int&nbsp;typeId,
                                  <a href="../../../graphdb/Direction.html" title="enum in org.neo4j.graphdb">Direction</a>&nbsp;direction,
                                  long&nbsp;firstRelId,
                                  boolean&nbsp;incrementCount)</pre>
<div class="block">Puts a relationship id to be the head of a relationship chain. If the node is sparse then
 the head is set directly in the cache, else if dense which head to update will depend on
 the <code>direction</code>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>nodeId</code> - node to update relationship head for.</dd>
<dd><code>typeId</code> - relationship type id.</dd>
<dd><code>direction</code> - <a href="../../../graphdb/Direction.html" title="enum in org.neo4j.graphdb"><code>Direction</code></a> this node represents for this relationship.</dd>
<dd><code>firstRelId</code> - the relationship id which is now the head of this chain.</dd>
<dd><code>incrementCount</code> - as side-effect also increment count for this chain.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the previous head of the updated relationship chain.</dd>
</dl>
</li>
</ul>
<a id="markChunkAsChanged(long,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>markChunkAsChanged</h4>
<pre class="methodSignature">private&nbsp;void&nbsp;markChunkAsChanged&#8203;(long&nbsp;nodeId,
                                boolean&nbsp;dense)</pre>
</li>
</ul>
<a id="calculateNumberOfDenseNodes()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calculateNumberOfDenseNodes</h4>
<pre class="methodSignature">long&nbsp;calculateNumberOfDenseNodes()</pre>
</li>
</ul>
<a id="chunkOf(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chunkOf</h4>
<pre class="methodSignature">private&nbsp;int&nbsp;chunkOf&#8203;(long&nbsp;nodeId)</pre>
</li>
</ul>
<a id="chunkChangeMask(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chunkChangeMask</h4>
<pre class="methodSignature">private static&nbsp;byte&nbsp;chunkChangeMask&#8203;(boolean&nbsp;dense)</pre>
</li>
</ul>
<a id="markAsChanged(org.neo4j.internal.batchimport.cache.ByteArray,long,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>markAsChanged</h4>
<pre class="methodSignature">private&nbsp;boolean&nbsp;markAsChanged&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                              long&nbsp;nodeId,
                              int&nbsp;mask)</pre>
</li>
</ul>
<a id="nodeIsChanged(org.neo4j.internal.batchimport.cache.ByteArray,long,long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nodeIsChanged</h4>
<pre class="methodSignature">private&nbsp;boolean&nbsp;nodeIsChanged&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                              long&nbsp;nodeId,
                              long&nbsp;mask)</pre>
</li>
</ul>
<a id="setRelationshipId(org.neo4j.internal.batchimport.cache.ByteArray,long,long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setRelationshipId</h4>
<pre class="methodSignature">private static&nbsp;void&nbsp;setRelationshipId&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                                      long&nbsp;nodeId,
                                      long&nbsp;firstRelId)</pre>
</li>
</ul>
<a id="getRelationshipId(org.neo4j.internal.batchimport.cache.ByteArray,long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRelationshipId</h4>
<pre class="methodSignature">private static&nbsp;long&nbsp;getRelationshipId&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                                      long&nbsp;nodeId)</pre>
</li>
</ul>
<a id="all48Bits(org.neo4j.internal.batchimport.cache.ByteArray,long,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>all48Bits</h4>
<pre class="methodSignature">private static&nbsp;long&nbsp;all48Bits&#8203;(<a href="ByteArray.html" title="interface in org.neo4j.internal.batchimport.cache">ByteArray</a>&nbsp;array,
                              long&nbsp;index,
                              int&nbsp;offset)</pre>
</li>
</ul>
<a id="all48Bits(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>all48Bits</h4>
<pre class="methodSignature">private static&nbsp;long&nbsp;all48Bits&#8203;(long&nbsp;raw)</pre>
</li>
</ul>
<a id="getFirstRel(long,org.neo4j.internal.batchimport.cache.NodeRelationshipCache.GroupVisitor)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFirstRel</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getFirstRel&#8203;(long&nbsp;nodeId,
                        <a href="NodeRelationshipCache.GroupVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.GroupVisitor</a>&nbsp;visitor)</pre>
<div class="block">Used when setting node nextRel fields. Gets the first relationship for this node,
 or the relationship group id. As a side effect this method also creates a relationship group
 if this node is dense, and returns that relationship group record id.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>nodeId</code> - id to get first relationship for.</dd>
<dd><code>visitor</code> - <a href="NodeRelationshipCache.GroupVisitor.html" title="interface in org.neo4j.internal.batchimport.cache"><code>NodeRelationshipCache.GroupVisitor</code></a> which will be notified with data about group to be created.
 This visitor is expected to create the group.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the first relationship if node is sparse, or the result of <a href="NodeRelationshipCache.GroupVisitor.html" title="interface in org.neo4j.internal.batchimport.cache"><code>NodeRelationshipCache.GroupVisitor</code></a> if dense.</dd>
</dl>
</li>
</ul>
<a id="setForwardScan(boolean,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setForwardScan</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setForwardScan&#8203;(boolean&nbsp;forward,
                           boolean&nbsp;denseNodes)</pre>
<div class="block">First a note about tracking which nodes have been updated with new relationships by calls to
 <a href="#getAndPutRelationship(long,int,org.neo4j.graphdb.Direction,long,boolean)"><code>getAndPutRelationship(long, int, Direction, long, boolean)</code></a>:

 We use two high bits of the count field in the "main" array to mark whether or not a change
 have been made to a node. One bit for a sparse node and one for a dense. Sparse and dense nodes
 now have different import cycles. When importing the relationships, all relationships are imported,
 one type at a time, but only dense nodes and relationship chains for dense nodes are updated
 for every type. After all types have been imported the sparse chains and nodes are updated in one pass.

 Tells this cache which direction it's about to observe changes for. If <code>true</code> then changes
 marked as the change-bit set and an unset change-bit means a change is the first one for that node.
 <code>false</code> is the opposite. This is so that there won't need to be any clearing of the cache
 in between forward and backward linking, since the cache can be rather large.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>forward</code> - <code>true</code> if going forward and having change marked as a set bit, otherwise
 change is marked with an unset bit.</dd>
<dd><code>denseNodes</code> - whether or not this is about dense nodes. If so then some additional cache
 preparation work needs to be done.</dd>
</dl>
</li>
</ul>
<a id="getCount(long,int,org.neo4j.graphdb.Direction)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCount</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getCount&#8203;(long&nbsp;nodeId,
                     int&nbsp;typeId,
                     <a href="../../../graphdb/Direction.html" title="enum in org.neo4j.graphdb">Direction</a>&nbsp;direction)</pre>
<div class="block">Returns the count (degree) of the requested relationship chain. If node is sparse then the single count
 for this node is returned, otherwise if the node is dense the count for the chain for the specific
 direction is returned.

 For dense nodes the count will be reset after returned here. This is so that the same memory area
 can be used for the next type import.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>nodeId</code> - node to get count for.</dd>
<dd><code>typeId</code> - relationship type id to get count for.</dd>
<dd><code>direction</code> - <a href="../../../graphdb/Direction.html" title="enum in org.neo4j.graphdb"><code>Direction</code></a> to get count for.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>count (degree) of the requested relationship chain.</dd>
</dl>
</li>
</ul>
<a id="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre class="methodSignature">public&nbsp;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;toString()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></code></dd>
</dl>
</li>
</ul>
<a id="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;close()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/AutoCloseable.html?is-external=true#close()" title="class or interface in java.lang" class="externalLink">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang" class="externalLink">AutoCloseable</a></code></dd>
</dl>
</li>
</ul>
<a id="acceptMemoryStatsVisitor(org.neo4j.internal.batchimport.cache.MemoryStatsVisitor)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>acceptMemoryStatsVisitor</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;acceptMemoryStatsVisitor&#8203;(<a href="MemoryStatsVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor</a>&nbsp;visitor)</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="MemoryStatsVisitor.Visitable.html#acceptMemoryStatsVisitor(org.neo4j.internal.batchimport.cache.MemoryStatsVisitor)">acceptMemoryStatsVisitor</a></code>&nbsp;in interface&nbsp;<code><a href="MemoryStatsVisitor.Visitable.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor.Visitable</a></code></dd>
</dl>
</li>
</ul>
<a id="nullSafeMemoryStatsVisitor(org.neo4j.internal.batchimport.cache.MemoryStatsVisitor.Visitable,org.neo4j.internal.batchimport.cache.MemoryStatsVisitor)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nullSafeMemoryStatsVisitor</h4>
<pre class="methodSignature">static&nbsp;void&nbsp;nullSafeMemoryStatsVisitor&#8203;(<a href="MemoryStatsVisitor.Visitable.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor.Visitable</a>&nbsp;visitable,
                                       <a href="MemoryStatsVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor</a>&nbsp;visitor)</pre>
</li>
</ul>
<a id="changeMask(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>changeMask</h4>
<pre class="methodSignature">private static&nbsp;int&nbsp;changeMask&#8203;(boolean&nbsp;dense)</pre>
</li>
</ul>
<a id="visitChangedNodes(org.neo4j.internal.batchimport.cache.NodeRelationshipCache.NodeChangeVisitor,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>visitChangedNodes</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;visitChangedNodes&#8203;(<a href="NodeRelationshipCache.NodeChangeVisitor.html" title="interface in org.neo4j.internal.batchimport.cache">NodeRelationshipCache.NodeChangeVisitor</a>&nbsp;visitor,
                              int&nbsp;nodeTypes)</pre>
<div class="block">Efficiently visits changed nodes, e.g. nodes that have had any relationship chain updated by
 <a href="#getAndPutRelationship(long,int,org.neo4j.graphdb.Direction,long,boolean)"><code>getAndPutRelationship(long, int, Direction, long, boolean)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>visitor</code> - <a href="NodeRelationshipCache.NodeChangeVisitor.html" title="interface in org.neo4j.internal.batchimport.cache"><code>NodeRelationshipCache.NodeChangeVisitor</code></a> which will be notified about all changes.</dd>
<dd><code>nodeTypes</code> - which types to visit (dense/sparse).</dd>
</dl>
</li>
</ul>
<a id="clearChangedChunks(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clearChangedChunks</h4>
<pre class="methodSignature">private&nbsp;void&nbsp;clearChangedChunks&#8203;(boolean&nbsp;denseNodes)</pre>
<div class="block">Clears the high-level change marks.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>denseNodes</code> - <code>true</code> for clearing marked dense nodes, <code>false</code> for clearing marked sparse nodes.</dd>
</dl>
</li>
</ul>
<a id="chunkHasChange(long,byte)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chunkHasChange</h4>
<pre class="methodSignature">private&nbsp;boolean&nbsp;chunkHasChange&#8203;(long&nbsp;nodeId,
                               byte&nbsp;chunkMask)</pre>
</li>
</ul>
<a id="calculateMaxMemoryUsage(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calculateMaxMemoryUsage</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;calculateMaxMemoryUsage&#8203;(long&nbsp;numberOfRelationships)</pre>
</li>
</ul>
<a id="calculateMaxMemoryUsage(long,long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calculateMaxMemoryUsage</h4>
<pre class="methodSignature">public static&nbsp;long&nbsp;calculateMaxMemoryUsage&#8203;(long&nbsp;numberOfDenseNodes,
                                           long&nbsp;numberOfRelationships)</pre>
</li>
</ul>
<a id="countingCompleted()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>countingCompleted</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;countingCompleted()</pre>
</li>
</ul>
<a id="getNumberOfDenseNodes()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNumberOfDenseNodes</h4>
<pre class="methodSignature">public&nbsp;long&nbsp;getNumberOfDenseNodes()</pre>
</li>
</ul>
<a id="memoryEstimation(long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>memoryEstimation</h4>
<pre class="methodSignature">public&nbsp;<a href="MemoryStatsVisitor.Visitable.html" title="interface in org.neo4j.internal.batchimport.cache">MemoryStatsVisitor.Visitable</a>&nbsp;memoryEstimation&#8203;(long&nbsp;numberOfNodes)</pre>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/NodeRelationshipCache.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2002&#x2013;2020 <a href="https://neo4j.com/">The Neo4j Graph Database Project</a>. All rights reserved.</small></p>
</footer>
</body>
</html>
